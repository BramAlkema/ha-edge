# Home Assistant Add-on: GCP Tunnel Client
# https://developers.home-assistant.io/docs/add-ons/configuration

name: GCP Tunnel Client
version: "2.2.0"
slug: gcp_tunnel_client
description: >-
  Secure tunnel to Google Cloud Run for external Home Assistant access.
  No port forwarding required. One-click setup with Google Assistant integration.
url: https://github.com/BramAlkema/gcp-ha-tunnel
arch:
  - aarch64
  - amd64
  - armv7
  - armhf
  - i386
startup: system
boot: auto
init: false

# Web UI for setup
ingress: true
ingress_port: 8099
ingress_stream: false
panel_icon: mdi:cloud-sync
panel_title: GCP Tunnel

# Options with defaults
options:
  server_url: ""
  auth_user: "hauser"
  auth_pass: ""
  local_port: 8123
  keepalive: "25s"
  log_level: "info"
  google_project_id: ""
  google_secure_devices_pin: ""
  remote_ui_enabled: false

# Schema validation - make most fields optional for auto-setup
schema:
  server_url: url?
  auth_user: str?
  auth_pass: password?
  local_port: int(1,65535)?
  keepalive: match(^\d+[smh]$)?
  log_level: list(debug|info|warning|error)?
  google_project_id: str?
  google_secure_devices_pin: str?
  remote_ui_enabled: bool?

# Map config folder with write access
map:
  - config:rw

# Watchdog to restart on failure
watchdog: tcp://[HOST]:[PORT:8123]
